\documentclass[12pt]{article}

\usepackage[a4paper,margin=1in]{geometry}
\usepackage{setspace}
\usepackage{lmodern}
\usepackage[english]{babel}
\usepackage{mathtools,amsthm,amssymb,amsmath}
\numberwithin{equation}{section}
\usepackage{booktabs} % For better-looking tables
\usepackage{dcolumn}  % For aligning decimal points in tables
\usepackage{bm}
\usepackage{hyperref}
\usepackage{ marvosym }
\usepackage{eurosym}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{subfig}

\setlength{\parindent}{0pt}     % No paragraph indentation
\setlength{\parskip}{1em}       % Add vertical space between paragraphs

\newcommand{\N}[1]{\mathcal{N}\left(#1\right)}
\newcommand{\Z}{\mathbb{Z}}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\given}{\,\middle|\,}
\newcommand{\Bern}[1]{\mathrm{Bern}(#1)}
\newcommand{\Bin}[1]{\mathrm{Bin}(#1)}
\newcommand{\Exp}[1]{\mathrm{Exp}(#1)}
\newcommand{\FS}[1]{\mathrm{FS}(#1)}
\newcommand{\Geo}[1]{\mathrm{Geo}(#1)}
\newcommand{\Norm}[1]{\mathrm{Norm}(#1)}
\newcommand{\Pois}[1]{\mathrm{Pois}(#1)}
\newcommand{\Unif}[1]{\mathrm{Unif}(#1)}
\newcommand{\E}[1]{\,\mathbb{E}\left[#1\right]}
\newcommand{\EE}[2]{\,\mathsf{E}_{#1}\left[#2\right]}
\newcommand{\V}[1]{\,\mathsf{V}\left[#1\right]}
\newcommand{\cov}[1]{\,\mathsf{Cov}\left[#1\right]}
\renewcommand{\d}[1]{\,\textrm{d}#1}
\newcommand{\1}[1]{\,\mathbb{1}_{#1}} % indicator
\renewcommand{\P}[1]{\,\mathbb{P}\left\{#1\right\}}
\newcommand{\fat}[1]{\ThisStyle{\hstretch{1.2}{\ooalign{%
  \kern.46pt$\SavedStyle#1$\cr\kern.33pt$\SavedStyle#1$\cr%
  \kern.2pt$\SavedStyle#1$\cr$\SavedStyle#1$}}}}
\renewcommand{\ln}[1]{\,\mathrm{ln}\left[#1\right]}
\newcommand*{\B}[1]{\ifmmode\bm{#1}\else\textbf{#1}\fi}
\title{GCM summary and solutions to exercises}
\author{Koen Stevens}
\date{\today}
\begin{document}
\maketitle
\tableofcontents
\section{Preliminaries}
\subsection{Game Theory}
\subsubsection{Nash Equilibrium}
Each player is choosing the best possible strategy given the strategies chosen by the other players.
\begin{align}
	s^*_i\in \underset{s_i}{\argmax}\,U_i(s^*_1,\cdots,s^*_i,\cdots,s_n^*),\forall i=1,\cdots n.
\end{align}
There is $\in$ instead of $=$ since this Nash Equilibrium does not need to be unique.
\subsubsection{Reaction functions}
A reaction function (or best reply or best response function) gives the best action for a player
given the actions of the other players. The Nash Equilibrium is where all reaction functions intersect.
\subsubsection{Symmetry}
When the game is symmetric, i.e. all players are in the same conditions, have the same reaction function
etcetera, then the players are anonymous (They are indistinguishable from each other except for
name or index). Then all players choose the same strategy $s^*$ in the Nash Equilibrium.
\subsubsection{Sub-game perfect equilibrium}
When players do not move simultaneously, i.e. the players move sequentially, we need to refine
definition of Nash Equilibrium: the sub-game perfect equilibrium requires that the strategy profile
under consideration is not only the equilibrium for the entire game but also for each sub-game.
\subsubsection{Moves of nature}
Many models in IO involve uncertainty. This is often modeled as a “move of nature” in a
multistage game. The moment at which the uncertainty is resolved, is referred to as the
move of nature. Such games can again be solved using backward induction
*** Candidate equilibrium
For ease of exposition, we will often use the concept of a candidate equilibrium. In many
models, it is possible to make an educated guess as to what the equilibrium might be. We
will refer to such an educated guess as a candidate equilibrium. A candidate equilibrium thus is a
strategy profile that may be a (subgame perfect) Nash equilibrium, but for
which we still have to check whether that really is the case. This approach for finding
an equilibrium is often easier than deriving an equilibrium from scratch. Note however
that if it turns out that the candidate equilibrium is a true equilibrium, we still have not
established whether that equilibrium is unique.
*** Mixed strategies
Players are not restricted to always play some action $a_i^*$ in equilibrium. A mixed strategy
equilibrium has each player drawing its action from some probability distribution $F_i(a_i)$,
defined on some domain $A_i$. Given the strategies played by all other players, each player $i$
is indifferent between the actions among which it mixes. Hence, $\E{U_i(a_i)}$ is constant
for all $a_i\in A_i$.
\subsection{Models with differentiated products}
\subsubsection{Hotelling competition}
With horizontal product differentiation different consumers prefer different products. With
vertical product differentiation all consumers agree which product is preferable.

In Hotelling, consumers are normally distributed on line of unit length, the number of consumer
is normalized to 1. Consumers either buy 1 unit of good, or none. Each consumer obtains gross
utility $v$ from consuming the product. There are 2 firms, one located at 0, one located at 1.
Consumer located at $x$ needs to travel distance $x$ to buy from firm 0 and $1-x$ distance to
buy from firm 1. Transportation costs are $t$ per unit of distance. Marginal costs for both firms
are constant and equal to $c$. From this information it can be concluded that in equilibrium both
firms charge the same price since the game is symmetric.
Suppose firm $i$ charges price $P_i$. Then a consumer located at $x$ buys from firm 0 iff
\begin{align}
	v-P_0-tx>v-P_1-t(1-x)
\end{align}
provided that $v-P_0-tx>0$. Assume entire market is covered: in equilibrium prices are s.t.
everyone consumes. This implies that $v>2t$.

Define a consumer $z$ that is indifferent between buying from 0 or 1. Every consumer located at
$x<z$ buys from 0, every consumer $x>z$ buys from 1. This consumer $z$ is located at
\begin{align}
	P_0+tz                & =P_1+t(1-z)                     \\
	\Longleftrightarrow z & =\frac{1}{2}+\frac{P_1-P_0}{2t}
\end{align}
Total sales for firm 0 equal $z$ and for firm 1 $1-z$. When they charge the same price
$z=\frac{1}{2}$. Profits for firm 0 are:
\begin{align}
	\Pi_0 & = (P_0-c)z                                         \\
	      & =(P_0-c)\left(\frac{1}{2}\frac{P_1-P_0}{2t}\right)
\end{align}
Then we maximize wrt $P_0$ to get reaction function:
\begin{align}
	P_0=R_0(P_1)=\frac{1}{2}(c+t+P_1)
\end{align}
And by symmetry:
\begin{align}
	P_1=R_1(P_0)=\frac{1}{2}(c+t+P_0)
\end{align}
Thus, in equilibrium (by equation the two reaction functions):
\begin{align}
	P_0^* & =P_1^*=c+t          \\
	\Pi_0 & =\Pi_1=\frac{1}{2}t
\end{align}
\subsubsection{The circular city: Salop}
Consumers are located uniformly on the edge of a circle with perimeter equal to 1. Consumers wish to buy
1 unit of good, have valuation $v$ and transport cost $t$ per unit of distance. Each firm is
allowed to locate in 1 location. There is a fixed cost of entry $f$ and marginal costs $c$.
Hence, firm $i$ has profit $(p_i-c)D_i-f$ if it enters (where $D_i$) is the demand it faces, and
0 otherwise.

In the first stage, the firms decide simultaneously whether to enter or not. Let $n$ denote the
number of entering firms. The firms are located equidistant from each other on the edge of the
circle.

This can be solved using backward induction. Assume $n$ firms have entered, and suppose all
firms except firm 0 charge price $p$, then firm 0 charges price $R_0(p)$. In equilibrium,
$R_0(p^*)=p^*$. Let firm 0 have location 0. The location of firm 0's right-hand neighbor is
$\frac{1}{n}$ (firm 1). Consider consumers located between firm 0 and 1. If firm 0 charges
price $p_0$, then the consumer $z_{0-1}$ that is indifferent between firm 0 and 1 is:
\begin{align}
	p_0+tz_{0-1}                & =p+t\left(\frac{1}{n}-z_{0-1}\right) \\
	\Longleftrightarrow z_{0-1} & =\frac{1}{2n}+\frac{p-p_0}{2t}
\end{align}
The same holds for the left-hand side of firm 0, hence its profits are:
\begin{align}
	\Pi_0(p_0,p)=2(p_0-c)\left(\frac{1}{2n}+\frac{p-p_0}{2t}\right)
\end{align}
Maximize w.r.t. $p_0$ to find the reaction function:
\begin{align}
	R_0(p)=\frac{1}{2}\left(p+c+\frac{t}{n}\right)
\end{align}
Then we impose symmetry:
\begin{align}
	p^*=c+\frac{t}{n}\text{ with profits }\Pi^*=\frac{t}{n^2}
\end{align}
Now we move back to stage 1. Firms enter the market as long as profits are positive. Hence,
the number of enterers is s.t.
\begin{align}
	\Pi^*-f=\frac{t}{n^2}-f=0\Longleftrightarrow n^* & =\sqrt{\frac{t}{f}} \\
	\Longrightarrow p^*                              & =c+\sqrt{tf}
\end{align}
Consumer's average transportation cost is $\frac{t}{4n}=\frac{\sqrt{tf}}{4}$. When the entry
cost tends to 0 the number of entering firms tends to infinity and the market price tends
to marginal cost.

A social planner would choose $n$ in order to minimize the sum of fixed cost and transportation
costs: $\underset{n}{\min}\left(nf+\frac{t}{4n}\right)
	\Longrightarrow n=\frac{1}{2}\sqrt{\frac{t}{f}}=\frac{1}{2}n^*$, hence the market generates
too many firms. Similar results hold for quadratic transportation costs.

There are three natural extensions that would make the model more realistic: the
introduction of a location choice, the possibility that firms do not enter simultaneously,
and the possibility that a firm locates at several points in the product space.
\subsubsection{Perloff and Salop}
Suppose there are two firms, $A$ and $B$, and a unit mass of consumers. Consumer $j$ has a
willingness to pay for the product of firm $i\in\{A,B\}$ that is given by $v+\epsilon_{ij}$,
where $\epsilon_{ij}$ is the realization of a r.v. with cumulative distribution function $F$ on
some interval $[0,\Bar{\epsilon}]$, and continuously differentiable density $f$. Assume $v$ is
high enough that all consumers buy in equilibrium. All draws are independent from each other,
$\epsilon_{ij}$ can be interpreted as the match value between product $i$ and consumer $j$.
Assume all firms have constant marginal cost equal to $c$.

Firstly, suppose both firms charge same price $p^*$. This will happen in equilibrium since the
game is symmetric. Then a consumer buys from $A$ whenever $\epsilon_A>\epsilon_B$ and from $B$
otherwise. To find the equilibrium we need to analyze what happens if firm $A$ defects from a
candidate equilibrium $p^*$ by setting some different price. Without loss of generality assume $A$
defects to some $p_A>p^*$. Denote $\Delta\equiv p_A-p^*$. Now, a consumer buys from firm $A$ if
$\epsilon_A-\Delta>\epsilon_B$. Assume for simplicity the $\epsilon$ are drawn from uniform
distribution on $[0,1]$. Then, the total sales of firm $A$ from charging price
$p_A=p^*+\Delta$ equal $q_A=\frac{1}{2}(1-\Delta)^2$. Hence the expected profits of firm $A$ are
\begin{align}
	\pi_A=(p_A-c)q_A
\end{align}
Profit maximization requires:
\begin{align}
	\frac{\partial\pi_A}{\partial p_A} & =(p_A-c)\frac{\partial q_A}{\partial p_A}+q_A=0,
	\text{ with }\label{eq:FOC_perloff_salop}                                             \\
	\frac{\partial q_A}{\partial p_A}  & =-(1-\Delta)
\end{align}
Then if we take first order condition and impose symmetry, $\Delta=0$ and $q_A=\frac{1}{2}$, we get:
\begin{align}
	(p_A-c)(-1)+\frac{1}{2} & =0             \\
	\Longleftrightarrow p^* & =c+\frac{1}{2}
\end{align}

In the model description the assumption that $v$ is high enough s.t. each consumer will buy in
equilibrium was made. We thus need that a consumer with $(\epsilon_A,\epsilon_B)=(0,0)$ would still
be willing to buy. In this case, with $p^*=c+\frac{1}{2}$ this implies $v>c+ \frac{1}{2}$

We can generalize the model for any distribution function $F$. Then:
\begin{align}
	q_A & = \int_\Delta^1\left(\int_0^{\epsilon_A-\Delta}f(\epsilon_B)\d\epsilon_B\right)f(\epsilon_A)\d\epsilon_A \\
	    & = \int_\Delta^1F(\epsilon_A-\Delta)f(\epsilon_A)\d\epsilon_A
\end{align}
Using Leibnitz' rule, this implies:
\begin{align}
	\frac{\partial q_A}{\partial p_A}=-\int_\Delta^1f(\epsilon_A-\Delta)f(\epsilon_A)\d\epsilon_A
	\label{eq:pa_leibnitz}
\end{align}
Again we can find the equilibrium price by taking first-order condition (\ref{eq:FOC_perloff_salop})
and using (\ref{eq:pa_leibnitz}). In equilibrium $\Delta=0$ and $q_A= \frac{1}{2}$. This yields:
\begin{align}
	p^*=c+\frac{1}{2\int_0^1f^2(\epsilon)\d\epsilon}
\end{align}
Note that the Perloff-Salop model is similar in spirit to the Hotelling model, in the
sense that each consumer has a certain valuation for each firm’s product. The crucial
difference is that in the Hotelling model, these valuations are perfectly negatively cor-
related: a consumer that has a very high valuation for product A, say, necessarily has
a very low valuation for product B, and vice-versa. In the Perloff-Salop model, these
valuations are independent of each other. A consumer with a high valuation for product
A may very well have a high valuation for product B as well. This also implies that the
Perloff-Salop model can easily be generalized to more than 2 firms.
\subsection{Exercises}
\begin{enumerate}
	\item Consider the following Cournot model. Two firms set quantities. Demand is given by
	      $q=1-p$. Marginal costs are either equal to 0 or 0.4, both with equal probability.
	      Derive the Cournot equilibrium if
	      \begin{enumerate}
		      \item uncertainty is resolved before firms set their quantities.
		      \item uncertainty is resolved after firms set their quantities.
	      \end{enumerate}

	      Solution:
	      \begin{enumerate}
		      \item The game is symmetric, hence in equilibrium both firms set the same
		            price. Let $c=0$. The firms maximize expected profit:
		            \begin{align*}
			            \pi_i=(1-q_1-q_2)q_i\Longrightarrow\frac{\partial\pi_i}{\partial q_i} & =1-q_j-2q_i      \\
			            \overset{\text{FOC}}{\Longrightarrow} q_i                             & =\frac{1-q_j}{2}
		            \end{align*}
		            By symmetry:
		            \begin{align*}
			            q=\frac{1-q}{2}\Longleftrightarrow q & =\frac{1}{3} \\
			            \Longrightarrow p                    & =\frac{1}{3} \\
			            \text{ with profits } \pi_i=\pi      & =\frac{1}{9}
		            \end{align*}
		            Let $c=0.4$. The firms maximize expected profit:
		            \begin{align*}
			            \pi_i=(1-q_1-q_2)q_i-0.4q_i\Longrightarrow\frac{\partial\pi_i}{\partial q_i} & =0.6-q_j-2q_i      \\
			            \overset{\text{FOC}}{\Longrightarrow}q_i                                     & =\frac{0.6-q_j}{2}
		            \end{align*}
		            Again imposing symmetry:
		            \begin{align*}
			            q=\frac{0.6-q}{2}\Longleftrightarrow q & =\frac{1}{5}  \\
			            \Longrightarrow p                      & =\frac{3}{5}  \\
			            \text{ with profits } \pi_i=\pi        & =\frac{3}{25}
		            \end{align*}
		      \item The expected marginal cost is $\E{c}=0.2$. The firms maximize
		            expected profit:
		            \begin{align*}
			            \pi_i                                             & =(1-q_1-q_2)q_i-\E{c}q_i \\
			            \Longrightarrow\frac{\partial\pi_i}{\partial q_i} & =(1-\E{c})-q_j-2q_i      \\
			            \overset{\text{FOC}}{\Longrightarrow}q_i          & =\frac{0.8-q_j}{2}
		            \end{align*}
		            By symmetry:
		            \begin{align*}
			            q=\frac{0.8-q}{2}\Longleftrightarrow q   & =\frac{4}{15}   \\
			            \Longrightarrow p                        & =\frac{7}{15}   \\
			            \text{ with expected profits } \pi_i=\pi & =\frac{28}{225}
		            \end{align*}
	      \end{enumerate}
	\item Consider a Hotelling model. Consumers are uniformly distributed on a line of unit
	      length. Consumers either buy one unit of the good or none at all. Each consumer
	      obtains gross utility $v$ from consuming the product. We have two firms: one is
	      located at 0, the other is located at 1. Marginal costs for both firms are constant
	      and equal to $c$. However, transportation costs are constant: a consumer that has
	      to travel a distance $x$ incurs transport costs $tx^2$. Derive the equilibrium prices.

	      Solution: This game is symmetric hence in equilibrium both firms set the same price.
	      Consider the indifferent consumer with location $z$, then:
	      \begin{align*}
		      v-P_0-tz^2                   & =v-P_1-t(1-z)^2                        \\
		      \Longleftrightarrow P_0+tz^2 & =P_1+t(1-z)^2                          \\
		      \Longrightarrow z            & =\sqrt{\frac{1}{2}+\frac{P_1-P_0}{2t}}
	      \end{align*}
	      Firm 0 its expected profits are:
	      \begin{align*}
		      \pi_0                                             & =(P_0-c)z=(P_0-c)\sqrt{\frac{1}{2}+\frac{P_1-P_0}{2t}}                                       \\
		      \Longrightarrow\frac{\partial\pi_0}{\partial P_0} & =\sqrt{\frac{1}{2}+\frac{P_1-P_0}{2t}}-\frac{P_0-c}{4t\sqrt{\frac{1}{2}+\frac{P_1-P_0}{2t}}} \\
		      \overset{\text{FOC}}{\Longrightarrow}2P_1         & =3P_0-c-2t
	      \end{align*}
	      Imposing symmetry:
	      \begin{align*}
		      2P=3P-c-2t\Longleftrightarrow P=c+2t
	      \end{align*}
	\item Consider the Perloff-Salop model where consumers have a valuation that is uniformly
	      distributed on $[0, 1]$. For simplicity, $c = 0$. Assume however that $v = 0$ such
	      that not all consumers buy in equilibrium. Derive the equilibrium prices.

	      Solution: Let $p_A=p_B=p^*$. Then, a consumer buys from $A$ if:
	      \begin{align*}
		      \epsilon_A-p^*                & >\max\{\epsilon_B-p^*,0\} \\
		      \Longleftrightarrow\epsilon_A & >\max\{\epsilon_B,p^*\}
	      \end{align*}
	      A consumer buys from $B$ if $\epsilon_B>\max\{\epsilon_A,p^*\}$, and does not buy if
	      both $\epsilon_A<p^*$ and $\epsilon_B<p^*$. Firm $A$ faces demand:
	      \begin{align*}
		      q_A & =\P{\epsilon_A>\max\{\epsilon_B,p^*\}}                                                           \\
		          & = \int_0^1\P{\epsilon_A>\max\{\epsilon_B,p^*\}\given\epsilon_B}f(\epsilon_B)\d\epsilon_B         \\
		          & = \int_0^1\P{\epsilon_A>\max\{\epsilon_B,p^*\}}\d\epsilon_B                                      \\
		          & = \int_0^{p^*}\P{\epsilon_A>p^*}\d\epsilon_B + \int_{p^*}^1\P{\epsilon_A>\epsilon_B}\d\epsilon_B \\
		          & = \int_0^{p^*}(1-p^*)\d\epsilon_B + \int_{p^*}^1(1-\epsilon_B)\d\epsilon_B                       \\
		          & = p^*(1-p^*) + (1-p^*) - \frac{1-(p^*)^2}{2}                                                     \\
		          & = \frac{1-(p^*)^2}{2}
	      \end{align*}
	      The expected profit function of firm $A$ is then:
	      \begin{align*}
		      \pi_A                                             & =p^*q_A=p^*\frac{1-(p^*)^2}{2}=\frac{1}{2}p^*-\frac{1}{2}(p^*)^3 \\
		      \Longrightarrow\frac{\partial\pi_A}{\partial p^*} & =\frac{1}{2}-\frac{3}{2}(p^*)^2                                  \\
		      \overset{\text{FOC}}{\Longrightarrow}p^*          & =\frac{1}{\sqrt{3}}
	      \end{align*}
\end{enumerate}
\section{Consumer search}
\subsection{The standard Bertrand Model}
Consider two firms that produce identical goods. There are no frictions, i.e
the consumers buy from the firm that sets the lowest price. If they set
the same price they both get half the market share. Assume firms can
fulfill any demand they face. The demand function is $q=D(p)$, marginal
costs constant equal $c$. Monopoly profits assumed to be strictly concave,
bounded and the monopoly price is given by:
\begin{align}
	p_m=\underset{p}{\argmax}(p-c)D(p)
\end{align}
Demand for firm $i$ is written \(D_i(p_i,p_j)\):
\begin{align}
	D_i(p_i,p_j) =
	\begin{cases}
		D(p_i)            & \text{if }p_i<p_j \\
		\frac{1}{2}D(p_i) & \text{if }p_i=p_j \\
		0                 & \text{if }p_i>p_j
	\end{cases}
\end{align}
The profits of firm $i$ are then:
\begin{align}
	\Pi_i(p_i,p_j)=(p_i-c)D_i(p_i,p_j)
\end{align}
This profit function is discontinuous.

First consider the case when \(p_j>p_m\). In such a case the best
reply of firm \(i\) is to set \(p_i=p_m\). Then it attracts all consumers,
while charging the monopoly price.

Now suppose \(c<p_j\leq p_m\). Firm \(i\) has three choices. Charging
price \(p_i>p_j\) it has zero profits. Charging price \(p_i=p_j\),
its sales are \(\frac{1}{2}D(p_j)\). Given the concavity of the profit
function and the fact that \(p_j<p_m\), the best response of \(i\) is to
set the price slightly below \(p_j\), say \(p_i=p_j-\epsilon\), with
\(\epsilon\) arbitrarily small.

Consider the case when \(p_j<c\). Undercutting now yields negative profits.
Hence, the best reply is to set any price \(p_i>p)j\) with zero profit.

Finally, consider the case in which \(p_j=c\). Undercutting again leads
to negative profits. Both \(p_i=p_j\) and \(p_i>p_j\) yield 0 profits.
Therefore the best reply is to set any \(p_i\geq c\).

Summarizing:
\begin{align}
	R_i(p_j)=
	\begin{cases}
		\in(p_j,\infty) & \text{if }p_j<c         \\
		\in[c,\infty)   & \text{if }p_j=c         \\
		p_j-\epsilon    & \text{if }c<p_j\leq p_m \\
		p_m             & \text{if }p_j>p_m
	\end{cases}
\end{align}
From this we conclude there is unique Nash equilibrium where both firms
charge price \(c\), with zero profit for both firms.

This result is known as the \textit{Bertrand paradox}. It qualifies as a paradox
since it is hard to believe that two firms is already enough to restore
competitive outcome in a market. When only two firms are active in a
market, one would expect them to make positive profits.
\subsection{A model of sales}
Consider a duopoly that competes in prices. Assume there is a mass of
consumers that equals 1, where each consumer is willing to pay at most
1 for the product. Each consumer demands only one unit of product:
\begin{align}
	D(p)=
	\begin{cases}
		1 & \text{if }p\leq1 \\
		0 & \text{if }p>1
	\end{cases}
\end{align}
Assume 0 marginal costs, and that there are two types of consumers:
A fraction of \(\lambda\) consumers is informed, which implies they can
observe the prices of both firms. The remaining fraction of \(1-\lambda\)
is uninformed: they pick at random which firm to go to and buy the
product if the price does not exceed 1.

The expected profits for firm \(i\) are given by:
\begin{align}
	\Pi_i(p_i,p_j)=
	\begin{cases}
		0                                                & \text{if }p_i>1         \\
		\frac{1}{2}(1-\lambda)p_i                        & \text{if }1\geq p_i>p_j \\
		\frac{1}{2}p_i                                   & \text{if }p_i=p_j\leq1  \\
		\left[\lambda+ \frac{1}{2}(1-\lambda) \right]p_i & \text{if }p_i<p_j\leq1
	\end{cases}
\end{align}
provided \(p_i\leq1\).

We can derive the best-response functions. First, note that whenever
firm \(i\) would want to charge a higher price than \(j\), the best
option is to charge a price of 1, since it faces the same demand as any
other price in \((p_j,1]\), and maximizes its profits if it sets its
price at 1. This implies the following. Suppose \(p_j>0\). The best choice
for firm \(i\) is to either slightly undercut \(p_j\) which yields profits
\(\left[\lambda + \frac{1}{2}(1-\lambda) \right]p_j\) or to set \(p_i=1\),
yields profits \(\frac{1-\lambda}{2}\). Firm \(i\) strictly prefers the
first strategy when:
\begin{align}
	\lambda p_j+\frac{1}{2}(1-\lambda) & >\frac{1}{2}(1-\lambda)      \\
	\Longleftrightarrow p_j            & >\frac{1-\lambda}{1+\lambda}
\end{align}
This yields the reaction functions:
\begin{align}
	R_i(p_j)=
	\begin{cases}
		1            & \text{if }p_j\leq\frac{1-\lambda}{1+\lambda} \\
		p_j-\epsilon & \text{if }p_j>\frac{1-\lambda}{1+\lambda}
	\end{cases}
\end{align}
There is no Nash equilibrium in pure strategies. Suppose firm 1 sets
\(p_1=1\). Firm 2 will slightly undercut. But now, firm 1 wants to
undercut firm 2 again. This process continues until
\(p=\frac{1-\lambda}{1+\lambda}\). Then no firm has incentive to
undercut the other, but each firm does have an incentive to defect by
setting its price equal 1, where the whole process starts anew.

There is however, an equilibrium in mixed strategies. Suppose both firms
draw their price from some continuous distribution function \(F(p)\)
on the support \(\left[\underline{p},\overline{p}\right]\). For this too
be an equilibrium, we need that given that firm \(j\) uses the mixed
strategy, any \(p_i\in\left[\underline{p},\overline{p}\right]\) must
yield the same expected profit for firm \(i\).

Note that the profits that firms make in the mixed strategy equilibrium
can not be lower than \(\frac{1-\lambda}{2}\), then a firm could just set
price 1 and have more profits. This implies we can not have \(\overline{p}>1\).
Consider the possibility that \(\overline{p}<1\). A firm charging price
\(\overline{p}\) is certain that it is charging the highest price on the
market. Then it can do better by charging price 1 instead. Hence we must
have \(\overline{p}=1\).

A firm charging \(\overline{p}=1\) makes profit \(\frac{1-\lambda}{2}\),
this implies that any \(p\in\left[\underline{p},\overline{p}\right]\)
must yield those same profits. Consider a firm charging \(\underline{p}\).
With certainty, this firm charges the lowest price. Its profits then
equal \(\left[\lambda+ \frac{1}{2}(1-\lambda) \right]\underline{p}\).
This has to equal \(\frac{1-\lambda}{2}\), we thus have that
\(\underline{p}=\frac{1-\lambda}{1+\lambda}\).

If firm \(i\) charges price \(p\), the probability that firm \(j\) charges
a lower price if \(F(p)\). When setting some
\(p_i\in\left[\underline{p},\overline{p}\right]\), expected profits are:
\begin{align}
	\E{\pi_i(p)} & =F(p)\left(\frac{1}{2}(1-\lambda)\right)p+
	(1-F(p))\left(\lambda+\frac{1}{2}(1-\lambda)\right)p      \\
	             & =\frac{1}{2}(1-\lambda)p+(1-F(p))\lambda p
\end{align}
We thus need:
\begin{align}
	\frac{1}{2}(1-\lambda)p+(1-F(p))\lambda p=\frac{1-\lambda}{2}, &  &
	\forall p\in\left[\frac{1-\lambda}{1+\lambda},1\right]
\end{align}
Solving for \(F(p)\) yields:
\begin{align}
	F(p)=1-\frac{(1-\lambda)(1-p)}{2\lambda p}
\end{align}
The equilibrium profits of both firms in this equilibrium equal
\(\frac{1-\lambda}{2}\), which is strictly positive. Hence, there is no
Bertrand paradox in this set-up.
\subsection{The Diamond paradox}
\subsubsection{Model}
Consider a slight change of the basic model with homogeneous products and equal
marginal costs. We assume that consumers have to incur search costs to
find out which price each firm charges. These search costs are $s$,
where $s$ can be arbitrarily small. Visiting the first shop is free,
but to visit any additional shop, a consumer has to incur search costs
$s$. Suppose again that there is a unit mass of consumers that all have
a willingness to pay for one unit of the product that equals $v$. Firms
have constant marginal costs $c < v$. It is crucial that consumers
cannot observe prices before they visit a shop. For simplicity, we assume
that there are only two firms.

The timing of the game is as follows. First, firms set prices that are
not observable. Second, consumers visit the shop of their first choice,
and observe the price that is set by that shop. Third, consumers either
buy from this shop, decide to visit the other shop, or decide not to buy
at all. The equilibrium now also depends on what consumers expect. That
makes it hard to derive reaction functions in the usual manner; these
reaction functions now also depend on the behavior of consumers. We
therefore choose a different manner of analysis. We first postulate a
candidate equilibrium. Then, we derive whether any firm (or the
consumers, for that matter), has an incentive to defect from that
equilibrium.

A natural candidate equilibrium seems to be the one that is the
equilibrium in the standard Bertrand model, in which both firms charge a
price $c$, consumers split evenly in the choice of their first shop,
and consumers also decide to buy at the shop they first visit. It is easy
to see, however, that this cannot be an equilibrium. Suppose that firm 1
deviates and increases its price to $c + \frac{s}{2}$. First, such a
defection cannot influence the number of consumers that visit this shop,
as consumers can only observe the price after they have visited. Hence,
all consumers that visit this shop are now unpleasantly surprised. Yet,
they still have no reason to choose a different strategy in the sub-game
that follows. Going to the other shop implies a cost-saving of
$\frac{s}{2}$ due to a lower price (note that we consider a deviation
from the Nash equilibrium by firm 1, which implies that firm 2 is still
charging price $c$), but an increase in search cost by $s$. Hence,
consumers will not continue search and the deviation is profitable.

But the same argument holds for any symmetric candidate equilibrium
that has $p<v$. For a price $p\geq v$, consumers also will not switch for
a small price increase, but a firm is not willing to defect such a
manner, as by definition it would decrease its profits.

Thus, the unique equilibrium has both firms charging the monopoly price,
even with infinitesimally small search costs. This is known as the
\textit{Diamond paradox}. Also note that this result does not hinge on
the number of firms. For any $n\geq2$, the analysis applies and the
unique equilibrium has prices equal to the monopoly price.
\subsubsection{What if the first visit is not free?}
In this model, the assumption that the first visit is free is somewhat odd. Suppose that
a consumer would also have to pay s to visit the first firm. Following the logic above,
the unique Nash equilibrium would have all firms charging the monopoly price $pm = v$.
But now suppose that consumers also have to pay s to visit the first firm. This will not
change the logic of the analysis; it would still be an equilibrium to have $p = v$. Once the
consumer has visited the first firm, the search costs $s$ are already sunk so she could either
buy at that firm and pay 1, or go home without the product and still having incurred
search costs $s$.

But a rational consumer will foresee this. Knowing that all firms will charge price $v$,
and knowing that she has to incur search costs $s$ to visit one, she knows that it is not a
good idea to enter this market, since doing so so will leave her with a negative surplus
of $-s$. Firms would like to commit to charge a lower price of $v-s$, but cannot do so;
once a consumer enters their shop they have an incentive to defect to charging a price $v$
anyhow. Hence, the market will break down and cease to exist.

We can get around this by assuming that each consumer has an individual downward
sloping demand function $D(p)$. At a monopoly price of $p_m$, each consumer then demands
more than one unit and still has some consumer surplus $S$. Firms do not have an incentive
to defect to a higher price: Again consumers will not switch for a small price increase,
but a firm is not willing to defect such a manner, as by definition it would decrease its
profits. As long as its consumer surplus $S$ this is bigger than the search cost $s$, the market
would still exist, as the consumer would still be willing to pay the first visit.
\subsubsection{Implications}
This result, that even infinitessimally small search costs are enough to switch from an
equilibrium with marginal cost pricing to one with monopoly pricing, is known as the
\textit{Diamond paradox}. It shows that even the slightest perturbation of the original model is
already enough to end up in the other extreme outcome.

Another surprising outcome of the model is that, although we have introduced search
costs, people do not actually end up searching in the equilibrium of this model: in
equilibrium, they also end up buying from the first firm they encounter.

To find a way out of the Diamond paradox, we can do two things. First, we can
assume that not all consumers have positive search costs. If some consumers can observe
all prices, firms may still have an incentive to defect from the monopoly price. Second,
we may assume that products are differentiated. We will discuss these two approaches in
what follows. But before we can do so, we first have to delve somewhat deeper in optimal
consumer search.
\subsection{Optimal search}
Suppose firms sell homogeneous products and prices at each firm are drawn
from a cumulative distribution $F(p)$, with a different draw for each
firm. There are $n$ firms, and the consumer has unit demand. A consumer
incurs search costs $s$ per firm it visits.

We focus on \textit{sequential search}: after each firm a consumer visits,
he can decide whether to continue search. With \textit{sequential search}
the consumer has to decide beforehand how many firms to visit. With
\textit{perfect recall} a consumer can decide at some point in the process
that he wants to go back to a firm he visited before, he can do so for free.

Consider $n=2$. Our consumer has visited 1 firm, denote as firm 1. At that
firm, price $p_1$ is observer. Suppose firm 2 is visited. If a price
$p_2>p_1$ is observed, the consumer returns to firm 1 and buys there.
If $p_2<p_1$ the consumer buys from firm 2 and his utility would increase by
$p_1-p_2$. Hence, the benefit from visiting the second firm is given by:
\begin{align}
	b(p_1)=\int_0^{p_1}(p_1-p_2)\d F(p_2)
\end{align}
The expected cost of visiting firm 2 is $s$. Hence the consumer is willing
to visit the last firm whenever $p_1>\hat{p}$, where $\hat p$ implicitly
defined by:
\begin{align}
	b(\hat p)=s
\end{align}
For existence of $\hat p$, note that:
\begin{align}
	b(\overline p) & =\int_0^{\overline p}(\overline p-p_2)\d F(p) \\
	               & = \overline p -\E{p},\text{ and }b(0)=0
\end{align}
$b(p)$ is strictly increasing in $p$. These observations imply that $\hat p$
always exists and is unique, provided that $s<\overline p-\E{p}$.

Now suppose $n=3$. At the first firm again, $p_1$ is observed. Denote
$B_1(p)$ as the expected net profit of doing one more search when the
current best price is $p$, and there is just one firm left to search.
Hence, $B_1(p)\equiv b(p)-s$. By construction $B_1(\hat p)=0$. Denote
$B_2(p)$ as the expected net benefit of doing another search when the
current best price is $p$ and there are two firms left to search.

We can use backward induction to evaluate $B_2(\hat p)$. Suppose that our
consumer is at the first of three shops, observer $p_1=\hat p$ and
considers whether it is worthwhile to to also visit shop 2. First suppose
$p_2<\hat p$. In that case the best price after visiting is $p_2$. As
$B_1(p_2)\leq B_1(\hat p)=0$ it will not be worthwhile to visit firm 3.
Now suppose $p_2\geq\hat p$. In that case the best price is still
$p_1=\hat p$. It will also not be worthwhile to visit firm 3 as by
construction $B_1(\hat p)=0$. In other words $B_2(p)=0$, so the
consumer will use the same reservation value regardless of whether there
are 1 or 2 firms left to search. By induction this also holds for
$3,4,\cdots$ firms left to search. Hence, \textit{the reservation price a
	consumer uses is independent of the number of firms she has left to
	search}. This implies to derive the optimal search rule, it is
not even necessary for the consumer to know how many firms there are left
to search.
\subsection{Search with homogeneous products}
Suppose there are $n$ firms and a unit mass of consumers. Customers have
unit demand and a willingness to pay of 1. A fraction $\lambda$ of
consumers has zero reach costs. The remaining fraction $1-\lambda$ has
reach costs $s\in(0,1)$. Again assume that the first visit is free.

An equilibrium in pure strategies does not exist. Firms either have
incentive to charge a slightly lower price to capture all
the shoppers or a much higher price to make a substantial profit on the
non-shoppers that happen to visit.

Given the reservation price $\hat p$ that non-shoppers will use we can
derive the price distribution $F(p)$ that firms will use.
Given the $F(p)$ that the firms will use we can derive the reservation
price $\hat p$ that consumers will use.

Suppose that one firm charges a price $p>\hat p$. Then both non-shoppers
and shoppers will not buy from this firm, hence this can not be part
of an equilibrium. This implies in equilibrium all firms set $p\leq\hat p$
which implies there will be no search in equilibrium, all non-shoppers
buy from the first firm they encounter. \textit{The equilibrium thus
	necessarily has all shoppers buying from the cheapest firm, and
	all non-shoppers buying from the first firm they encounter.}
\subsection{Search with differentiated products}
Suppose there are $n$ firms. Their costs are zero. There is a unit mass
of consumers that all have search costs $s$. If a consumer buys from $i$,
a utility is obtained:
\begin{align}
	U^i_j(p_i,\epsilon_i)=v+\epsilon_i-p_i,
\end{align}
where $v$ is large enough such that s.t. a consumer always buys in
equilibrium. We assume $\epsilon_i$ is the realization of a r.v. with
CDF $F$ and continuously differentiable density $f$. Assume $F$ is
log-concave. $\epsilon_{ij}$ can be interpreted as the match value
between consumer $j$ and product $i$. To find out this value, $j$ first
has to visit firm $i$. By assumption, firm $i$ never finds out
$\epsilon_{ij}$.

Assume that all firms charge some price $p^*$. Suppose our consumer
visits firm $i$ and finds match value $\epsilon_{ij}$. Buying from $i$
yields utility $v+\epsilon_{ij}-p^*$. A visit to some other firm $k$ will
give utility $v+\epsilon_{kj}-p^*$. This is higher than utility of buying
from $i$ if $\epsilon_{kj}>\epsilon_{ij}$. Then the expected benefit from
searching once more is then:
\begin{align}
	b(\epsilon_{ij})=\int_{\epsilon_{ij}}^\infty(\epsilon-\epsilon_{ij})\d F(\epsilon)
\end{align}
The consumer searches until a match value that is at least equal to
$\hat\epsilon$, where $b(\hat\epsilon)=s$. Given that $s$ is low enough,
such a $\hat\epsilon$ always exists and is unique.
\subsubsection{2 firms, uniform distribution}
If all firms charge $p^*$ and the consumer finds $\epsilon_i$ at the first
firm, the expected benefit from visiting the other firm is:
\begin{align}
	b(\epsilon_i)=\frac{(1-\epsilon_i)^2}{2}
\end{align}
Since visiting one more firm costs $s$, you will do so whenever
$b(\epsilon_i)>s$, hence if $\epsilon_i>\hat\epsilon$, with:
\begin{align}
	\hat\epsilon=1-\sqrt{2s}
	\label{eq:epshat}
\end{align}
When $s=0$, consumers will continue searching for any value of $\epsilon$
they find at the first firm. The higher $s$, the lower $\hat\epsilon$,
hence the earlier they are going to settle for the product they find at
the first firm they visit.

Suppose that a consumer visits firm $i$ first and finds price $p$. If
this consumer buys from $i$, utility $v+\epsilon_i-p$ is obtained. A
visit to the other firm will give utility $v+\epsilon_j-p^*$. Hence,
$j$ is preferred over $i$ whenever $\epsilon_j>\epsilon_i+\Delta$, with
$\Delta\equiv p^*-p$.  If prices were equal the consumer would buy from $i$
whenever $\epsilon_i>\hat\epsilon$. But if firm $i$ now charges a price
that is $\Delta$ lower, buying from i gives an additional utility of
$\Delta$ relative to buying from the other firm. Hence, this consumer
now buys from $i$ whenever $\epsilon_i+\Delta>\hat\epsilon$.

The next step is to find the demand of firm $i$ if it charges $p$ rather
than $p^*$. There are 3 ways in which a consumer ends up buying from
firm $i$.

First, with probability $\frac{1}{2}$ firm $i$ is visited
first, and with this consumer buys right away if $\epsilon_i>\hat\epsilon-\Delta$,
which happens with probability $1-\hat\epsilon+\Delta$. Hence the
probability this occurs is:
\begin{align}
	\frac{1}{2}(1-\hat\epsilon+\Delta)
	\label{eq:ch2prob1}
\end{align}

Second, with probability $\frac{1}{2}$ the consumer visits firm $j$ first.
With probability $\hat\epsilon$ a match value that is too low is found.
Then a match that is high enough at firm $i$ is found with probability
$1-\hat\epsilon+\Delta$. Hence the joint probability of this is:
\begin{align}
	\frac{1}{2}\hat\epsilon(1-\hat\epsilon+\Delta)
	\label{eq:ch2prob2}
\end{align}

Third, it could be the case that she visits both firms, but finds a match value at both
firms that is too low. Then, she will just go back to the firm that with hindsight offers
the best deal. The consumer buys from $i$ in this way when all of the
following conditions hold:
\begin{align}
	\epsilon_i & <\hat\epsilon-\Delta \\
	\epsilon_j & <\hat\epsilon        \\
	\epsilon_i & >\epsilon_j-\Delta
\end{align}
This happens with probability:
\begin{align}
	\frac{1}{2}(\epsilon^2-\Delta^2)
	\label{eq:ch2prob3}
\end{align}

Then we can sum \ref{eq:ch2prob1}, \ref{eq:ch2prob2} and
\ref{eq:ch2prob3} to obtain the probability that a firm buys from $i$:
\begin{align}
	D_i(p^*,\Delta) & =
	\frac{1}{2}(1-\hat\epsilon+\Delta)+
	\frac{1}{2}\hat\epsilon(1-\hat\epsilon+\Delta)+
	\frac{1}{2}(\epsilon^2-\Delta^2)                                         \\
	                & = \frac{1}{2}+\frac{1}{2}\Delta(1+\hat\epsilon-\Delta)
\end{align}
Note if both firms charge the same price, hence $\Delta=0$,
$D_i=\frac{1}{2}$.

Using the definition of $\Delta$:
\begin{align}
	D_i(p^*,p)=\frac{1}{2}+\frac{1}{2}(p^*-p)(1+\hat\epsilon-p^*+p)
\end{align}
Profits of firm $i$ equal $\pi_i=pD_i$, FOC gives:
\begin{align}
	\frac{\partial D_i}{\partial p}+D_i=0
\end{align}
To solve for equilibrium, impose symmetry, hence $D_i=\frac{1}{2}$.
Moreover:
\begin{align}
	\frac{\partial D_i}{\partial p} & =p^*-p-\frac{1}{2}(1+\hat\epsilon)                  \\
	                                & =-\frac{1}{2}(1+\hat\epsilon),\text{ with symmetry}
\end{align}

Hence, the equilibrium price is:
\begin{align}
	p^* & =\frac{1}{1+\hat\epsilon}                            \\
	    & =\frac{1}{2-\sqrt{2s}},\text{ using \ref{eq:epshat}}
\end{align}
Hence when the search costs are zero, the price equals $\frac{1}{2}$,
and the equilibrium prices increase with the search costs. With higher search
costs, a consumer that visits a firm is less likely to walk away, hence
firms have more market power and hence charge higher prices.
% \subsubsection{Solution of the general model}
% \subsection{Exercises}
% \section{Advertising}
\end{document}
